## 15 프로그램
JS는 실행되어야하는 웹사이트에 소스 형태로 제공.

- 웹 페이지에 몇 가지 상호 작용 기능 구현
    - HTML이 텍스트형태기에 JS역시 웹 페이지에 텍스트 형태로 삽입되는 것으로 결정.
        - 이런 형태로 코드가 제공되는것은 드물다.
        - 다른언어로 된 대부분의 프로그램은 특정 기계의 명령어코드 || 코드 제너레이터 || 인터프리터 가 해석할 수 있는 중간 바이트코드 명렁어 형태로 만들어져 실행되어야 하는 곳으로 전달된다.
        - 자바스크립트 엔진은 자바스크립트 소스코드를 컴파일해 기계어 || 중간언어 || 둘다(기계어, 중간어) 로 변환한다. ⇒ 자바스크립트는 이식성이 뛰어나다.
            - 실행되는 기계의 구조와 프로그램 사이에 아무런 **의존성이 없는것**이다.
            - JS프로그램은 기저가 무엇이든 상관없이 어떤 자바스크립트 엔진에서도 수정없이 동작한다.
            - 자바스크립트 컴파일러는
                - 프로그램의 중요한 보안 관련 속성을 쉽고 빠르게 확인할 수 있다.
                - 프로그램이 금지된 영역의 메모리 값을 훔쳐보지 않는다.
                - 자료형에 대한 제한을 위반하지 않는다.
                - 자바도 바이트코드 검증 툴로 이것과 비슷한 일을 하지만 JS만큼 빠르고 쉽고 확실하지는 않다.
                -

자바스크립트코드를 html에 포함시키는것이 좋지않다는 생각이 요즘 동향.

- 디자인 측면에서는 화면에 표현하는 부분과 동작하는 부분이 구분하기 어려움
- 성능상으로 페이지에 있는 코드를 압축하거나 캐싱 할 수 없다.
- 보안상으로도 xss (cross-site-scripting) 공격을 받을수 있기에 좋지 않다. (w3c의 콘텐츠 보안 정책을 지속적으로 사용해 페이지내에 소스코드를 포함시키지 않도록 해야한다.)

### 전역 변수

옛날 브라우저의 프로그래밍 모델에서는 함수 바깥의 모든 선언이 페이지(page) 스코프에 추가되었다.

- = 모두 전역으로 선언되었다.
- = 페이지 스코프에 있는 모든 변수는 해당 페이지에서 사용하는 모든 소스 단위에서 볼 수 있다.
- = 공유된 전역 변수를 통해 보안 취약점이 발생할 수 있다.
- = 결국 프로그램에 버그가 생기고, 망가지기 쉽다.

서로 관계가 없는 두 개 이상의 소스단위에서 우연히 같은 변수 이름을 사용한다면, 예측 할 수 없는 에러를 발생시킬 수도 있다. 그리고 심각한 보안 취약점 문제를 발생시킨다. xss공격에 기름을 붓는 격이다.

(저자는 전역변수는 악의 근원이라고…)

함수 밖에 변수를 선언하는 더 좋은 방법이 있다.

### 모듈(하나의 파일 정도로 생각하면 될듯)

이는 모듈스코프에 선언하는것이다.

모듈 스코프의 변수들은 해당 소스 유닛에 있는 함수들만 볼 수 있다. (더 강하고, 더 안전하고, 더 보안이 강한 설계가 가능하다.)

다른 소스 단위와 함께 쓰려면 import와 export문을 써서 명시적으로 하게된다. 이런 문장을 써서 나쁜프로그램이 될 수도 있고, 좋은 프로그램이 될 수 있다. 좋은프로그램이 되는것에 집중하자.

모듈을 export함으로써 다른 모듈에게 자신의 기능을 사용할 수 있도록 허용한다.

모듈은 일반적으로 하나의 함수 || 함수로 가득찬 한개의 객체와 같이 한가지만 export해야한다.

익스포트된 것은 다른 많은 모듈이 사용할 수 있으므로 예상치 못한 오류나 교차 오염을 막기위해 익스포트되는 내용을 동결하는것이 좋다.(as const). 익스포트는 일종의 인터페이스다. 인터페이스는 간단하고 명료해야한다.

소스유닛의 코드 몸체는 한번만 실행된다. 즉, 임포트하는 여러 주체들은 동일한 익스포트내용을 공유한다는것. 익스포트된 내용이 자체 상태를 가지고(stateful) 있는데 반해,

임포트해서 쓰는곳에서는 이들이 아주 깨끗하고 공유되지않는 인스턴스라고 생각하는 경우 문제가 발생한다. 이렇게 사용하고 싶다면 깨끗하고 공유되지않는 인스턴스를 만들 수 있는 팩토리 함수를 익스포트하는것이 좋다.

????? export문은 인스턴스를 만들지 않는다. ???? 무슨말이지 ⇒ 두분 다 이해 노노?ㅇㅇ

`export default exportation;`

`default` 라는 단어를 붙여 써야한다는것은 정말 불행한 일이다?(이름이 바뀔수 있어서 가독성측면이든 뭐든 안좋을수 있기에…?)

exportation에 들어가는 내용은 익스포트하고자 하는 동결된 함수 또는 객체표현식이다.
임포트해서 하나의 소스 유닛이 다른 소스 유닛의 함수나 객체를 받아 사용가능하다.

받아온 함수나 객체를 저장할 새로운 변수의 이름을 지정한다. 모듈의 위치를 큰따옴표로 둘러싼 문자열 리터럴로 지정해 사용하는 시스템이 소스 유닛의 위치를 찾아 읽고 컴파일하고 적재하고 실행해 해당 모듈의 익스포트를 사용할 수 있게 한다.

(import *** from ‘위치’)

import문은 다른 위치에서 초기화된 값을 가져오는 특수한 const 문처럼 사용이 가능하다

export 문은 한번만 쓰는게 좋다. import문은 필요한 만큼 사용해도 된다.

> export default vs export
* default를 붙인건 내보낸 이름으로 사용할 필요가 없다.(커스텀가능), 중괄호 필요 없음
* 없는건 중괄호가 필요하며 내보낸 이름으로 사용해야함.
>

### 응집도(Cohesion)과 결합도(Coupling)

미시적수준에서 좋은 프로그래밍이란 좋은 코딩 규칙에 달려있다.

규칙이 좋은 코드와 에러를 만드는 나쁜코드를 시각적으로 쉽게 구분 할 수 있게 해준다.

거시적 수준에서 좋은 프로그래밍은 좋은 모듈설계에 달렸다.

좋은 모듈은 응집도가 좋다 ⇒ 모듈의 모든 요소가 어우러져 **하나의 목적을 이루기 위해 함께 동작**한다는것이다.

나쁜 모듈은 **좋지 않은 구조**와 더불어 **모듈에서 너무 많은 일을 하려고 하다 보니 응집도가 낮다.**

(항공서 만든 validationinput 같이…)

좋은 모듈들은 약하게 결합되어있다. 모듈의 인터페이스를 제대로 사용하기 위해 모듈의 모든 내용을 알 필요는 없다. 꼭 필요한 내용만 알면된다. 어떻게 구현되었는지 알 필요는 없다.

좋지 않은 모듈은 강한 결합도를 초래한다. 자바스크립트는 이런 강한 결합도를 왕왕초래한다. 상호 의존적인 모듈은 결국 서로 강하게 결합할 수밖에 없다. 전역변수만큼 나쁘고 쓸대없이 거창하다.